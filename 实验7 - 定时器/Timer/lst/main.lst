C51 COMPILER V9.52.0.0   MAIN                                                              04/21/2015 09:28:34 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Object\main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c LARGE BROWSE INCDIR(compiler\c51;hal\nrf24le1;hal;hal\nrf24l01p;comp
                    -iler\common) DEBUG OBJECTEXTEND PRINT(.\lst\main.lst) TABS(2) OBJECT(.\Object\main.obj)

line level    source

   1          /****************************************Copyright (c)****************************************************
   2          **                                        
   3          **                                 
   4          **
   5          **--------------File Info---------------------------------------------------------------------------------
   6          ** File name:     main.c
   7          ** Last modified Date: 2015-4-16         
   8          ** Last Version:       1.2
   9          ** Descriptions:              
  10          **--------------------------------------------------------------------------------------------------------
  11          ** Created by:      FiYu
  12          ** Created date:    2014-11-12
  13          ** Version:         1.0
  14          ** Descriptions:    定时器实验          
  15          **--------------------------------------------------------------------------------------------------------
  16          ** Modified by:     FiYu
  17          ** Modified date:   
  18          ** Version:       
  19          ** Descriptions:    
  20          ** Rechecked by:      
  21          **********************************************************************************************************
             -/
  22          #include <stdio.h> 
  23          #include <reg24le1.h>
  24          #include <stdint.h>
  25          
  26          
  27          /*-------------------管脚定义--------------------------------------------------*/
  28          #define  D1    P00  // 开发板上的指示灯D1
  29          #define  D2    P01  // 开发板上的指示灯D2
  30          
  31          
  32          /* 开发板中nRF24LE1管脚配置
  33          P00：输出，驱动D4        P12：输入，按键检测S2  
  34          P01：输出，驱动D5        P13：输入，按键检测S3
  35          P02：输出                P14：输出
  36          P03：输出，UART TXD      P15：输出
  37          P04：输入，UART RXD      P16：输出
  38          P06：输入，AIN6  AD检测
  39          */
  40          
  41          #define TIMER0_VALUE  26666  //Timer0定时器定时20ms对应的数值
  42          
  43          uint8_t count=0; //软件计数变量
  44          
  45          
  46          /*******************************************************************************************************
  47           * 描  述 : 配置 IO P0.0和P0.1为输出
  48           * 入  参 : 无
  49           * 返回值 : 无
  50           *******************************************************************************************************/
  51          void IO_Init(void)
  52          { 
  53   1        P0DIR &= ~0x03;    //配置P0.0和P0.1为输出
C51 COMPILER V9.52.0.0   MAIN                                                              04/21/2015 09:28:34 PAGE 2   

  54   1        D1 = 1;            //设置D4初始状态为熄灭
  55   1        D2 = 1;            //设置D5初始状态为熄灭
  56   1      }
  57          
  58          /*******************************************************************************************************
  59           * 描  述 : 配置Timer0为16位定时器,定时时间20ms,开启中断
  60           * 入  参 : 无
  61           * 返回值 : 无
  62           *******************************************************************************************************/
  63          void Timer0Init(void)
  64          {
  65   1        TMOD = 0x01;                       //16位定时器
  66   1        TH0  = (65536-TIMER0_VALUE)/256;   //写入初值
  67   1        TL0  = (65536-TIMER0_VALUE)%256;
  68   1        ET0  = 1;    //使能Timer0溢出中断
  69   1        EA   = 1;    //使能全局中断
  70   1        TR0  = 1;    //启动Timer0
  71   1      }
  72          
  73          /*******************************************************************************************************
  74           * 描  述 : 主函数
  75           * 入  参 : 无
  76           * 返回值 : 无
  77           *******************************************************************************************************/
  78          void main(void)
  79          { 
  80   1        IO_Init();      //配置IO                                  
  81   1        Timer0Init();   //Timer0初始化
  82   1        
  83   1        while(1);       //死循环，等待Timer0溢出中断
  84   1      }
  85          /*******************************************************************************************************
  86           * 描  述 : Timer0中断服务函数
  87           * 入  参 : 无
  88           * 返回值 : 无
  89           *******************************************************************************************************/
  90          void Timer0_irq() interrupt INTERRUPT_T0
  91          {
  92   1        
  93   1        TH0=(65536-TIMER0_VALUE)/256;  //写入初值
  94   1        TL0=(65536-TIMER0_VALUE)%256;
  95   1        count++;      //软件计数器加1
  96   1        if(count==25) //500ms时间到 
  97   1        {
  98   2          count=0;    //软件计数器清零
  99   2          D1 = ~D1;   //D1指示灯状态取反
 100   2        }
 101   1      }
 102           /*********************************END FILE***************************************************************
             -*/  


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     69    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
